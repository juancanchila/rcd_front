<mat-toolbar color="primary">
  <span class="toolbar-title">Consulta de PIN</span>
</mat-toolbar>

<div class="content-wrapper" *ngIf="!loading; else loadingTpl">

  <!-- FORMULARIO -->
  <mat-card>
    <mat-card-header>
      <mat-card-title>Consultar PIN</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="consultaForm" (ngSubmit)="consultar()">

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Tipo de PIN</mat-label>
          <mat-select formControlName="tipo" required>
            <mat-option value="generador">Generador</mat-option>
            <mat-option value="transportador">Transportador</mat-option>
            <mat-option value="receptor">Receptor</mat-option>
            <mat-option value="vehiculo">VehÃ­culo</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Valor a buscar</mat-label>
          <input matInput formControlName="valor" required placeholder="Documento, nombre o placa">
        </mat-form-field>

        <button mat-raised-button color="primary" type="submit" [disabled]="consultaForm.invalid">
          Consultar
        </button>

      </form>
    </mat-card-content>
  </mat-card>



  <!-- ========================== -->
  <!--      GENERADOR             -->
  <!-- ========================== -->
  <mat-card *ngIf="generador">
    <mat-card-header>
      <mat-card-title>ðŸ“‚ Proyectos del Generador</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <table *ngIf="proyectos.length > 0" class="tabla-proyectos">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>UbicaciÃ³n</th>
            <th>Estado</th>
            <th>PIN</th>
            <th>Ver PIN</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let proyecto of proyectos">
            <td>{{ proyecto.nombre }}</td>
            <td>{{ proyecto.ubicacion }}</td>
            <td>{{ proyecto.estadoProyecto }}</td>
            <td>{{ proyecto.pin }}</td>
            <td>
              <button mat-icon-button (click)="goToPinProyecto(proyecto.id)">
                <mat-icon>picture_as_pdf</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <p *ngIf="proyectos.length === 0" class="sin-datos">
        No hay proyectos registrados.
      </p>
    </mat-card-content>
  </mat-card>



  <!-- ========================== -->
  <!--      TRANSPORTADOR         -->
  <!-- ========================== -->
  <mat-card *ngIf="transportador">
    <mat-card-header>
      <mat-card-title>ðŸšš VehÃ­culos del Transportador</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <table *ngIf="vehiculos.length > 0" class="tabla-vehiculos">
        <thead>
          <tr>
            <th>Placa</th>
            <th>Modelo</th>
            <th>Capacidad</th>
            <th>PIN</th>
            <th>Ver PIN</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let vehiculo of vehiculos">
            <td>{{ vehiculo.placaVehiculo }}</td>
            <td>{{ vehiculo.modelo }}</td>
            <td>{{ vehiculo.capacidad }}</td>
            <td>{{ vehiculo.pin }}</td>
            <td>
              <button mat-icon-button (click)="goToPinVehiculo(vehiculo.id)">
                <mat-icon>picture_as_pdf</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <p *ngIf="vehiculos.length === 0" class="sin-datos">
        No hay vehÃ­culos registrados para este transportador.
      </p>
    </mat-card-content>
  </mat-card>




  <!-- ========================== -->
  <!--    ðŸš— MÃšLTIPLES VEHÃCULOS  -->
  <!-- ========================== -->
  <mat-card *ngIf="vehiculosConsulta.length > 0">
    <mat-card-header>
      <mat-card-title>ðŸš— VehÃ­culos Encontrados</mat-card-title>
    </mat-card-header>

    <mat-card-content>

      <table class="tabla-vehiculos">
        <thead>
          <tr>
            <th>Placa</th>
            <th>Modelo</th>
            <th>Capacidad</th>
            <th>PIN</th>
            <th>Ver PIN</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let v of vehiculosConsulta">
            <td>{{ v.placaVehiculo }}</td>
            <td>{{ v.modelo }}</td>
            <td>{{ v.capacidad }}</td>
            <td>{{ v.pin }}</td>

            <td>
              <button mat-icon-button (click)="goToPinVehiculo(v.idvehiculo)">
                <mat-icon>picture_as_pdf</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>

      </table>

    </mat-card-content>
  </mat-card>



  <!-- ========================== -->
  <!--          RECEPTOR          -->
  <!-- ========================== -->
  <mat-card *ngIf="receptor">
    <mat-card-header>
      <mat-card-title>ðŸ“‚ Resoluciones del Receptor</mat-card-title>
    </mat-card-header>

    <mat-card-content>

      <table *ngIf="resoluciones.length > 0" class="tabla-resoluciones">
        <thead>
          <tr>
            <th>NÃºmero</th>
            <th>UbicaciÃ³n</th>
            <th>Actividad</th>
            <th>Tipo</th>
            <th>PIN</th>
            <th>Ver PIN</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let r of resoluciones">
            <td>{{ r.numeroResolucion }}</td>
            <td>{{ r.ubicacion }}</td>
            <td>{{ r.naturalezaActividad }}</td>
            <td>{{ r.tipoAprovechamiento }}</td>
            <td>{{ r.pin }}</td>

            <td>
              <button mat-icon-button (click)="goToPinResolucion(r.id)">
                <mat-icon>picture_as_pdf</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <p *ngIf="resoluciones.length === 0" class="sin-datos">
        No hay resoluciones registradas.
      </p>

    </mat-card-content>
  </mat-card>

</div>


<!-- LOADING -->
<ng-template #loadingTpl>
  <div class="spinner-wrapper">
    <mat-spinner></mat-spinner>
  </div>
</ng-template>
