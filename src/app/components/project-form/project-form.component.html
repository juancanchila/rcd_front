<div class="form-host">

  <!-- Barra de progreso -->
  <mat-progress-bar
    mode="determinate"
    [value]="(step + 1) * (100 / totalSteps)">
  </mat-progress-bar>

  <!-- PASO 0 — DATOS DEL VEHÍCULO -->
  <div *ngIf="step === 0">


   
 <project-data  [group]="proyecto!"></project-data>
<map-picker (coordinates)="onMap($event)"></map-picker>
    <div class="form-actions">
      <button mat-flat-button color="primary" (click)="nextStep()">Siguiente</button>
    </div>
    
  </div>

 <!-- PASO 1: DOCUMENTOS -->
<div *ngIf="step === 1" [formGroup]="vehicleDocumentsForm" class="vehicle-documents">
<div *ngIf="proyecto.get('tipo_de_generador')?.value === 'PEQUEÑO GENERADOR QUE NO REQUIERE LICENCIA O PERMISO.'">

<generator-general-documents></generator-general-documents>
</div>
<div *ngIf="proyecto.get('tipo_de_generador')?.value === 'PEQUEÑO GENERADOR DE RCD' ||
  proyecto.get('tipo_de_generador')?.value === 'GRAN GENERADOR DE RCD'">
<generator-general-documents></generator-general-documents>

<bigorsmall-documents></bigorsmall-documents>
</div>
  



  <!-- Mensaje general de validación -->
  <div class="form-errors" *ngIf="vehicleDocumentsForm.invalid && vehicleDocumentsForm.touched">
    <p class="error">Revisa los campos marcados en rojo y adjunta los documentos obligatorios.</p>
  </div>

  <!-- Botones -->
  <div class="form-actions">
    <button mat-stroked-button type="button" (click)="prevStep()">Anterior</button>
    <button mat-flat-button color="primary" type="button" (click)="nextStep()">Siguiente</button>
  </div>
</div>


  <!-- PASO 2 — INFORMACIÓN ADICIONAL -->
  <div *ngIf="step === 2" [formGroup]="infoextra">
    
    <h3>Información adicional</h3>

    <mat-form-field appearance="outline">
      <mat-label>Fecha de expedición del PIN</mat-label>
      <input matInput type="date" formControlName="fecha_expedicion_pin" />
      <mat-error *ngIf="isInvalid('fecha_expedicion_pin', infoextra)">
        Debes ingresar la fecha de expedición del PIN.
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Consecutivo SIGOB</mat-label>
      <input matInput formControlName="consecutivo_sigob" placeholder="Ej: 2025-000123" />
      <mat-error *ngIf="isInvalid('consecutivo_sigob', infoextra)">
        Debes ingresar el consecutivo SIGOB.
      </mat-error>
    </mat-form-field>

    <div class="form-actions">
      <button mat-stroked-button (click)="prevStep()">Anterior</button>
      <button mat-flat-button color="primary" (click)="nextStep()">Siguiente</button>
    </div>
  </div>

  <!-- PASO 3 — RESUMEN FINAL -->
  <div *ngIf="step === 3">
    <h2>Resumen del Vehículo</h2>

    <div class="summary-box">

      <p><strong>Clase:</strong> {{ vehicleForm.get('clase_vehiculo')?.value }}</p>
      <p><strong>Placa:</strong> {{ vehicleForm.get('placa_vehiculo')?.value }}</p>
      <p><strong>Marca:</strong> {{ vehicleForm.get('marca')?.value }}</p>
      <p><strong>Modelo:</strong> {{ vehicleForm.get('modelo')?.value }}</p>

      <p><strong>Capacidad:</strong>
        {{ vehicleForm.get('capacidad_vehiculo')?.value }}
        {{ vehicleForm.get('unidad_capacidad')?.value }}
      </p>

      <h3>Documentos cargados</h3>
      <ul>
        <li *ngFor="let doc of getUploadedDocuments()">{{ doc }}</li>
      </ul>

      <h3>Información adicional</h3>
      <p><strong>Fecha PIN:</strong> {{ infoextra.get('fecha_expedicion_pin')?.value }}</p>
      <p><strong>Consecutivo SIGOB:</strong> {{ infoextra.get('consecutivo_sigob')?.value }}</p>

    </div>

    <div class="form-actions">
      <button mat-stroked-button (click)="prevStep()">Anterior</button>
      <button mat-flat-button color="accent" (click)="onSubmit()">Guardar</button>
    </div>
  </div>

</div>
